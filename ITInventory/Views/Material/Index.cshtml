@model ContentManagementSystem.Models.MaterialViewModel

<div class="container-fluid">
    <div class="row">
        <!-- Sidebar -->
        @await Html.PartialAsync("_Sidebar")

        <!-- Main content -->
        <div class="col-md-10">
            <div class="container mt-4">
                @* <h2>Material IN</h2> *@
                <h3>Invoice Input Form</h3>

                @using (Html.BeginForm("Create", "Material", FormMethod.Post, new { enctype = "multipart/form-data", id = "materialForm", onsubmit = "return validateForm()" }))

                {
                    @Html.AntiForgeryToken()
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group mb-3">
                                @Html.LabelFor(m => m.NewMaterial.InvoiceNo, "Invoice Number", new { @class = "form-label" })
                                @Html.TextBoxFor(m => m.NewMaterial.InvoiceNo, new
                                    {
                                        @class = "form-control",
                                        placeholder = "Enter Invoice Number",
                                        required = "required",

                                        pattern = "^[a-zA-Z0-9-_/\\s]+$",

                                        title = "Invoice number can contain letters, numbers, hyphens, underscores, forward slashes and spaces"

                                    })
                                @Html.ValidationMessageFor(m => m.NewMaterial.InvoiceNo, "", new { @class = "text-danger" })
                            </div>
                            <div class="form-group mb-3">
                                @Html.LabelFor(m => m.NewMaterial.CompanyId, "Company", new { @class = "form-label" })
                                @Html.DropDownListFor(m => m.NewMaterial.CompanyId, (SelectList)ViewBag.Companies, null, new { @class = "form-control" })
                                @Html.ValidationMessageFor(m => m.NewMaterial.CompanyId, "", new { @class = "text-danger" })
                            </div>
                            <div class="form-group mb-3">
                                @Html.LabelFor(m => m.NewMaterial.AssetItemId, "Asset Item", new { @class = "form-label" })
                                @Html.DropDownListFor(m => m.NewMaterial.AssetItemId, (SelectList)ViewBag.AssetItems, "Select Asset Item", new { @class = "form-control", required = "required" })
                                @Html.ValidationMessageFor(m => m.NewMaterial.AssetItemId, "", new { @class = "text-danger" })
                            </div>
                            <div id="customAssetNameDiv" style="display:none;" class="form-group mb-3">
                                <label class="form-label">Custom Asset Name</label>
                                <input type="text" class="form-control" name="NewMaterial.CustomAssetName" id="customAssetName" placeholder="Optional" />
                            </div>
                            <div class="form-group mb-3">
                                @Html.LabelFor(m => m.NewMaterial.VendorId, "Vendor", new { @class = "form-label" })
                                @Html.DropDownListFor(m => m.NewMaterial.VendorId, (SelectList)ViewBag.Vendors, "Select Vendor", new { @class = "form-control", required = "required" })
                                @Html.ValidationMessageFor(m => m.NewMaterial.VendorId, "", new { @class = "text-danger" })
                            </div>
                            <div id="customVendorNameDiv" style="display:none;" class="form-group mb-3">
                                <label class="form-label">Custom Vendor Name</label>
                                <input type="text" class="form-control" name="NewMaterial.CustomVendorName" id="customVendorName" placeholder="Enter Vendor Name" />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group mb-3">
                                @Html.LabelFor(m => m.NewMaterial.ManufacturerId, "Manufacturer", new { @class = "form-label" })
                                @Html.DropDownListFor(m => m.NewMaterial.ManufacturerId, (SelectList)ViewBag.Manufacturers, "Select Manufacturer", new { @class = "form-control", required = "required" })
                                @Html.ValidationMessageFor(m => m.NewMaterial.ManufacturerId, "", new { @class = "text-danger" })
                            </div>
                            <div id="customManufacturerNameDiv" style="display:none;" class="form-group mb-3">
                                <label class="form-label">Custom Manufacturer Name</label>
                                <input type="text" class="form-control" name="NewMaterial.CustomManufacturerName" id="customManufacturerName" placeholder="Enter Manufacturer Name" />
                            </div>
                            <div class="form-group mb-3">
                                @Html.LabelFor(m => m.NewMaterial.BillDate, "Bill Date", new { @class = "form-label" })
                                <div class="input-group">
                                    <input type="text"
                                           id="BillDate"
                                           name="NewMaterial.BillDate"
                                           class="form-control date-picker"
                                           required
                                           placeholder="DD/MM/YYYY"
                                           autocomplete="off" />
                                    <span class="input-group-text">
                                        <i class="fas fa-calendar"></i>
                                    </span>
                                </div>
                                @Html.ValidationMessageFor(m => m.NewMaterial.BillDate, "", new { @class = "text-danger" })
                            </div>

                            <div class="form-group mb-3">
                                <label class="form-label">Received Date</label>
                                <div class="input-group">
                                    <input type="text"
                                           class="form-control date-picker"
                                           name="ReceivedDate"
                                           required
                                           placeholder="DD/MM/YYYY"
                                           autocomplete="off" />
                                    <span class="input-group-text">
                                        <i class="fas fa-calendar"></i>
                                    </span>
                                </div>
                            </div>
                            <div class="form-group mb-3">
                                @Html.LabelFor(m => m.NewMaterial.ReqnQuantity, "Receive Quantity", new { @class = "form-label" })
                                <div class="input-group">
                                    @Html.TextBoxFor(m => m.NewMaterial.ReqnQuantity, new { @class = "form-control", type = "number", min = "1", value = "1", id = "reqnQuantity", @readonly = "readonly" })
                                    @*  <button type="button" class="btn btn-secondary" onclick="decrementQuantity()">-</button> *@
                                    <button type="button" class="btn btn-secondary" onclick="incrementQuantity()">+</button>
                                </div>
                                @Html.ValidationMessageFor(m => m.NewMaterial.ReqnQuantity, "", new { @class = "text-danger" })
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Invoice Image</label>
                        <div>
                            <button type="button" class="btn btn-secondary" onclick="uploadInvoice()">
                                <i class="fas fa-upload"></i> Upload Invoice Images
                            </button>
                            <input type="file" id="invoiceUpload" name="ImageFile" style="display: none;" />
                        </div>
                    </div>

                    <div class="table-responsive" id="details">
                        <table class="table table-bordered" id="itemsTable">
                            <thead>
                                <tr>
                                    <th>Sr No</th>
                                    <th>Asset Type</th>
                                    <th class="d-none">AssetTypeId</th>
                                    <th>Serial No</th>
                                    @* <th id="thItemName" class="d-none">Item Name</th> *@
                                    <th id="thWarrantyDate">Warranty&nbsp;Date</th>
                                    <th>Model No</th>
                                    <th id="thGeneration">Generation</th>
                                    <th id="thCPU">Processor</th>
                                    <th id="thRAM">RAM (GB)</th>
                                    <th id="thHDD">Hard Disk</th>
                                    <th id="thSSD">SSD </th>
                                    <th id="thOther">Other</th>
                                </tr>
                            </thead>
                            <tbody id="itemsTableBody">
                            </tbody>
                        </table>
                    </div>

                    <div class="table-responsive" id="Otherdetails">
                        <table class="table table-bordered" id="itemsTable">
                            <thead>
                                <tr>
                                    <th>Sr No</th>
                                    <th>Asset Type</th>
                                    <th class="d-none">AssetTypeId</th>
                                    <th>Serial No</th>
                                    <th id="thItemName">Item Name</th>
                                    <th id="thWarrantyDate">Warranty Date</th>
                                    <th>Model No</th>
                                    <th id="thOther">Other</th>
                                </tr>
                            </thead>
                            <tbody id="itemsTableBody2">
                            </tbody>
                        </table>
                    </div>

                    <div class="text-end">
                        <button type="submit" class="btn btn-primary">Submit</button>
                        @* <a href="@Url.Action("InvoiceDashboard", "Material")" class="btn btn-secondary">View All Invoices</a> *@
                    </div>
                }
            </div>
        </div>
    </div>
</div>

@section Styles {
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
    <style>
        .datepicker {
            z-index: 1060 !important;
        }

        .input-group-text {
            cursor: pointer;
        }

            .input-group-text:hover {
                background-color: #e9ecef;
            }

        .datepicker table tr td.today {
            background-color: #FFF176 !important;
            border-color: #FFE082 !important;
        }

        .datepicker table tr td.active {
            background-color: #007bff !important;
            border-color: #0056b3 !important;
        }
    </style>
}

@section Scripts {
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="~/js/MatrialIn.js">
        <script>
        @if (TempData["Success"] != null)

        {
            <text>
                    $(document).ready(function() {
                        toastr.success('@TempData["Success"]');
                    });
            </text>
        }

    </script>
}

<style>
    .accordion-button:not(.collapsed) {
        background-color: #e7f1ff;
        color: #0c63e4;
    }

    .accordion-button:focus {
        box-shadow: none;
        border-color: rgba(0,0,0,.125);
    }

    .accordion-button span {
        flex: 1;
        text-align: left;
        margin-right: 1rem;
    }

    .table-sm td, .table-sm th {
        padding: 0.5rem;
        vertical-align: middle;
    }

    .accordion-body {
        padding: 1.5rem;
    }

    .table-hover tbody tr:hover {
        background-color: rgba(0,0,0,.075);
    }
</style> 